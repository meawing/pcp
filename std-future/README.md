# std::future

`Future` - представление некоторого значения, которое будет возвращено асинхронной операцией. По сути, между двумя объектами `Future` и `Promise` есть одноразовый канал, по которому можно передать значение из одного потока (или файбера) в другой.

`Future` - конец одноразового канала у потока, получающего значение
`Promise` - конец одноразового канала у потока, отдающего значение

Так как по семантике в коде есть связанные пары `Future` и `Promise` для их создания используется функция `std::pair<Future<T>, Promise<T>> GetTied()`

## Задача

Реализуйте аналог `std::future` из стандартной библиотеки c помощью библиотеки `lines`

- Метод `T Get()` у `Future` позволяет заблокироваться и дождаться появления значения
- Методы `void SetValue(T value)` и `void SetError()` пробрасывают во `Future` значение или ошибку

## SharedState

Для реализации понадобится вспомогательный класс `SharedState`. Это некоторое разделяемое состояние. Lifetime этого объекта таков, что разрушение происходит уже после разрушения `Future` и `Promise`. Возможны ситуации:
- `Future` оказалась не нужна, на ней не позвали `Get` и она разрушилась. При этом происходит Set на `Promise`.
- Произошёл `Set` на `Promise`, разрушение `Promise` и далее вызов `Get` на `Future`.

## Future<void>

Для того, чтобы не писать boilerplate code и не делать шаблонную специализацию `Future` и `Promise` для типа `void` применяет пустая структура `Unit`.

## Ссылки

[future](https://en.cppreference.com/w/cpp/thread/future)
[exception_ptr](https://en.cppreference.com/w/cpp/error/exception_ptr)
